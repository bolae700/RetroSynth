<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RETRO MINIMAL</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            cursor: none;
        }

        body {
            background: #000;
            color: #0f0;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Inter', sans-serif;
            padding: 10px;
            overflow: hidden;
        }

        /* Retro Grid Background */
        #gridCanvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }

        /* Modern Cursor */
        .cursor {
            position: fixed;
            width: 16px;
            height: 16px;
            pointer-events: none;
            z-index: 9999;
            mix-blend-mode: difference;
            transition: transform 0.08s;
            transform: rotate(-45deg);
        }

        .cursor::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-bottom: 16px solid #0f0;
        }

        .player-container {
            display: flex;
            gap: 15px;
            align-items: flex-start;
        }

        .player {
            width: 280px;
            background: rgba(0, 0, 0, 0.92);
            border: 1px solid #0f0;
            box-shadow: 
                0 0 0 1px #0f0,
                0 0 8px rgba(0, 255, 0, 0.15);
            padding: 18px;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(2px);
        }

        .player::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(45deg, transparent 49%, rgba(0, 255, 0, 0.005) 50%, transparent 51%);
            background-size: 3px 3px;
            pointer-events: none;
            z-index: 1;
        }

        .lyrics-panel {
            width: 280px;
            background: rgba(0, 0, 0, 0.92);
            border: 1px solid #0f0;
            box-shadow: 
                0 0 0 1px #0f0,
                0 0 8px rgba(0, 255, 0, 0.15);
            padding: 18px;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(2px);
            display: none;
        }

        .lyrics-panel::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(45deg, transparent 49%, rgba(0, 255, 0, 0.005) 50%, transparent 51%);
            background-size: 3px 3px;
            pointer-events: none;
            z-index: 1;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            position: relative;
            z-index: 2;
            border-bottom: 1px solid #0f0;
            padding-bottom: 12px;
        }

        .logo-section {
            display: flex;
            flex-direction: column;
        }

        .logo {
            font-family: 'Orbitron', monospace;
            font-size: 16px;
            font-weight: 700;
            letter-spacing: 2px;
            color: #0f0;
            margin-bottom: 2px;
        }

        .subtitle {
            font-size: 9px;
            color: #8f8;
            letter-spacing: 1px;
            font-weight: 300;
        }

        .datetime {
            text-align: left;
        }

        .time {
            font-family: 'Orbitron', monospace;
            font-size: 12px;
            font-weight: 600;
            color: #0f0;
            margin-bottom: 2px;
        }

        .date {
            font-size: 10px;
            color: #8f8;
            font-weight: 300;
        }

        .visualizer {
            position: relative;
            width: 100%;
            height: 70px;
            margin-bottom: 16px;
            background: rgba(0, 10, 0, 0.1);
            border: 1px solid #0f0;
            overflow: hidden;
        }

        #waveCanvas {
            width: 100%;
            height: 100%;
            display: block;
        }

        .track-info {
            text-align: center;
            margin-bottom: 14px;
            position: relative;
            z-index: 2;
        }

        .track-title {
            font-size: 14px;
            font-weight: 600;
            color: #0f0;
            margin-bottom: 3px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            letter-spacing: 0.5px;
        }

        .track-artist {
            font-size: 11px;
            color: #8f8;
            letter-spacing: 0.7px;
            font-weight: 300;
        }

        .progress-container {
            margin-bottom: 14px;
            position: relative;
            z-index: 2;
        }

        .progress-bar {
            width: 100%;
            height: 2px;
            background: rgba(0, 20, 0, 0.2);
            overflow: hidden;
            border: none;
        }

        .progress {
            height: 100%;
            background: #0f0;
            width: 0%;
            transition: width 0.1s;
        }

        .time-display {
            display: flex;
            justify-content: space-between;
            font-size: 10px;
            color: #8f8;
            margin-top: 6px;
            font-weight: 300;
            letter-spacing: 0.5px;
        }

        .controls {
            display: flex;
            justify-content: space-between;
            margin-bottom: 16px;
            position: relative;
            z-index: 2;
        }

        .control-btn {
            padding: 8px 12px;
            background: transparent;
            border: 1px solid #0f0;
            color: #0f0;
            cursor: none;
            font-size: 11px;
            font-weight: 400;
            transition: all 0.15s;
            letter-spacing: 0.5px;
            font-family: 'Inter', sans-serif;
            position: relative;
            overflow: hidden;
            flex: 1;
            margin: 0 4px;
            text-align: center;
        }

        .control-btn:active {
            background: rgba(0, 255, 0, 0.15);
            transform: scale(0.95);
        }

        .control-btn:hover {
            background: rgba(0, 255, 0, 0.08);
        }

        .play-pause {
            flex: 2;
            font-weight: 600;
            background: rgba(0, 255, 0, 0.03);
        }

        .playlist {
            max-height: 140px;
            overflow-y: auto;
            border: 1px solid #0f0;
            padding: 8px;
            background: rgba(0, 10, 0, 0.1);
            position: relative;
            z-index: 2;
        }

        .track-item {
            padding: 7px 9px;
            border-bottom: 0.5px solid rgba(0, 255, 0, 0.08);
            cursor: none;
            transition: all 0.15s;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 5px;
            font-size: 11px;
        }

        .track-item:hover {
            background: rgba(0, 255, 0, 0.06);
        }

        .track-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }

        .track-number {
            width: 20px;
            height: 20px;
            background: transparent;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: 600;
            color: #0f0;
            border: 1px solid #0f0;
            font-family: 'Orbitron', monospace;
        }

        .track-name {
            flex: 1;
            color: #8f8;
            font-weight: 400;
            letter-spacing: 0.5px;
        }

        .track-duration {
            font-size: 10px;
            color: #0f0;
            font-weight: 300;
            font-family: 'Orbitron', monospace;
        }

        .active-track {
            background: rgba(0, 255, 0, 0.1);
            border: 0.5px solid #0f0;
        }

        .active-track .track-number {
            background: #0f0;
            color: #000;
        }

        .active-track .track-name {
            color: #0f0;
            font-weight: 600;
        }

        ::-webkit-scrollbar {
            width: 2px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(0, 10, 0, 0.1);
        }

        ::-webkit-scrollbar-thumb {
            background: #0f0;
        }

        .footer {
            text-align: center;
            font-size: 9px;
            color: #0a0;
            margin-top: 14px;
            position: relative;
            letter-spacing: 1px;
            font-weight: 300;
            border-top: 0.5px solid #0f0;
            padding-top: 12px;
            z-index: 2;
        }

        .pulse {
            animation: pulse 3s infinite;
        }

        @keyframes pulse {
            0% { opacity: 0.9; }
            50% { opacity: 1; }
            100% { opacity: 0.9; }
        }

        /* Lyrics Panel Styles */
        .lyrics-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            position: relative;
            z-index: 2;
            border-bottom: 1px solid #0f0;
            padding-bottom: 12px;
        }

        .lyrics-title {
            font-family: 'Orbitron', monospace;
            font-size: 14px;
            font-weight: 700;
            letter-spacing: 1px;
            color: #0f0;
        }

        .close-lyrics {
            background: transparent;
            border: 1px solid #0f0;
            color: #0f0;
            font-size: 12px;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: none;
            transition: all 0.15s;
        }

        .close-lyrics:hover {
            background: rgba(0, 255, 0, 0.1);
        }

        .lyrics-content {
            height: 320px;
            overflow-y: auto;
            padding: 7px;
            font-size: 11px;
            line-height: 1.8;
            text-align: center;
            position: relative;
            z-index: 2;
        }

        .lyrics-line {
            margin-bottom: 12px;
            color: #8f8;
            transition: all 0.3s;
            padding: 5px;
        }

        .show-lyrics-btn {
            width: 100%;
            padding: 8px;
            background: transparent;
            border: 1px solid #0f0;
            color: #0f0;
            cursor: none;
            font-size: 11px;
            font-weight: 400;
            transition: all 0.15s;
            letter-spacing: 0.5px;
            font-family: 'Inter', sans-serif;
            margin-top: 12px;
        }

        .show-lyrics-btn:hover {
            background: rgba(0, 255, 0, 0.1);
        }
    </style>
</head>
<body>
    <!-- Retro Grid Background -->
    <canvas id="gridCanvas"></canvas>
    
    <!-- Modern Cursor -->
    <div class="cursor"></div>

    <div class="player-container">
        <div class="player">
            <div class="header">
                <div class="logo-section">
                    <div class="logo pulse">RETRO MINIMAL</div>
                    <div class="subtitle">MUSIC PLAYER</div>
                </div>
                <div class="datetime">
                    <div class="time" id="currentTime">00:00:00</div>
                    <div class="date" id="currentDate">Loading...</div>
                </div>
            </div>

            <div class="visualizer">
                <canvas id="waveCanvas"></canvas>
            </div>

            <div class="track-info">
                <div class="track-title" id="trackTitle">SELECT TRACK</div>
                <div class="track-artist" id="trackArtist">CLICK ON PLAYLIST</div>
            </div>

            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress" id="progress"></div>
                </div>
                <div class="time-display">
                    <span id="currentTrackTime">0:00</span>
                    <span id="trackDuration">0:00</span>
                </div>
            </div>

            <div class="controls">
                <button class="control-btn" id="prevBtn">⏮</button>
                <button class="control-btn play-pause" id="playPauseBtn">▶</button>
                <button class="control-btn" id="nextBtn">⏭</button>
            </div>

            <div class="playlist" id="playlist">
                <!-- Tracks will be added here by JavaScript -->
            </div>

            <button class="show-lyrics-btn" id="showLyricsBtn">SHOW LYRICS</button>

            <div class="footer">
                SYSTEM ONLINE | MULTI-GENRE | V10.0
            </div>
        </div>

        <div class="lyrics-panel" id="lyricsPanel">
            <div class="lyrics-header">
                <div class="lyrics-title">LYRICS</div>
                <button class="close-lyrics" id="closeLyricsBtn">X</button>
            </div>
            <div class="lyrics-content" id="lyricsContent">
                <!-- Lyrics will be displayed here -->
            </div>
        </div>
    </div>

    <script>
        // Retro Grid Background
        const gridCanvas = document.getElementById('gridCanvas');
        const gctx = gridCanvas.getContext('2d');
        
        // Set canvas size
        gridCanvas.width = window.innerWidth;
        gridCanvas.height = window.innerHeight;
        
        // Grid settings
        const gridSize = 40;
        const gridOffset = { x: 0, y: 0 };
        
        function drawGrid() {
            gctx.fillStyle = "rgba(0, 0, 0, 0.05)";
            gctx.fillRect(0, 0, gridCanvas.width, gridCanvas.height);
            
            // Draw grid lines
            gctx.strokeStyle = "rgba(0, 255, 0, 0.1)";
            gctx.lineWidth = 0.5;
            
            // Vertical lines
            for (let x = gridOffset.x % gridSize; x < gridCanvas.width; x += gridSize) {
                gctx.beginPath();
                gctx.moveTo(x, 0);
                gctx.lineTo(x, gridCanvas.height);
                gctx.stroke();
            }
            
            // Horizontal lines
            for (let y = gridOffset.y % gridSize; y < gridCanvas.height; y += gridSize) {
                gctx.beginPath();
                gctx.moveTo(0, y);
                gctx.lineTo(gridCanvas.width, y);
                gctx.stroke();
            }
            
            // Draw animated dots at grid intersections
            const time = Date.now() * 0.001;
            
            for (let x = gridOffset.x % gridSize; x < gridCanvas.width; x += gridSize) {
                for (let y = gridOffset.y % gridSize; y < gridCanvas.height; y += gridSize) {
                    const pulse = Math.sin(time + x * 0.01 + y * 0.01) * 0.3 + 0.7;
                    
                    gctx.beginPath();
                    gctx.arc(x, y, 0.5, 0, Math.PI * 2);
                    gctx.fillStyle = `rgba(0, 255, 0, ${0.2 * pulse})`;
                    gctx.fill();
                }
            }
            
            // Move grid slowly
            gridOffset.x += 0.2;
            gridOffset.y += 0.1;
        }

        // Modern Cursor
        const cursor = document.querySelector('.cursor');
        
        document.addEventListener('mousemove', (e) => {
            cursor.style.left = e.clientX + 'px';
            cursor.style.top = e.clientY + 'px';
        });
        
        // Add hover effect for interactive elements
        const interactiveElements = document.querySelectorAll('.control-btn, .track-item, .show-lyrics-btn, .close-lyrics');
        interactiveElements.forEach(el => {
            el.addEventListener('mouseenter', () => {
                cursor.style.transform = 'rotate(-45deg) scale(1.3)';
            });
            
            el.addEventListener('mouseleave', () => {
                cursor.style.transform = 'rotate(-45deg) scale(1)';
            });
        });

        // Date and Time
        function updateDateTime() {
            const now = new Date();
            
            // Format time
            const timeString = now.toLocaleTimeString('en-US', { 
                hour12: false,
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
            
            // Format date
            const dateString = now.toLocaleDateString('en-US', {
                weekday: 'short',
                year: 'numeric',
                month: 'short',
                day: 'numeric'
            });
            
            document.getElementById('currentTime').textContent = timeString;
            document.getElementById('currentDate').textContent = dateString;
        }

        // Update date/time every second
        setInterval(updateDateTime, 1000);
        updateDateTime();

        // Music tracks with direct URLs and lyrics
        const tracks = [
            { 
                id: 1, 
                name: "Asphalt Heartbeat", 
                url: "https://audio.jukehost.co.uk/g1mnUVIICxoL3IQgWT1D1eBE3PebQz2z", 
                duration: "5:12",
                lyrics: [
                    "Lights on. GO.",
                    "",
                    "Red line flash",
                    "Concrete dash",
                    "No time waste",
                    "Join the chase",
                    "City bright",
                    "Endless night",
                    "Feel the pace",
                    "In this race.",
                    "",
                    "The beat gets louder, feel the ground shake",
                    "Push it faster, for goodness sake!",
                    "",
                    "Asphalt heartbeat, syncs with mine",
                    "Crossing every single line!",
                    "Engine screams the name of night:",
                    "يا ليل! (Ya Layl!)",
                    "Burning through the neon light:",
                    "يا ليل! (Ya Layl!)",
                    "",
                    "Steel frame shakes",
                    "No mistakes",
                    "Pulse is high",
                    "Watch me fly",
                    "Ghosts behind",
                    "Lose my mind",
                    "Can't rewind",
                    "Leave them blind.",
                    "",
                    "The beat gets louder, feel the ground shake",
                    "Push it faster, for goodness sake!",
                    "",
                    "Asphalt heartbeat, syncs with mine",
                    "Crossing every single line!",
                    "Engine screams the name of night:",
                    "يا ليل! (Ya Layl!)",
                    "Burning through the neon light:",
                    "يا ليل! (Ya Layl!)",
                    "",
                    "Just the sound...",
                    "Spinning 'round...",
                    "Lost and found...",
                    "",
                    "Asphalt heartbeat, syncs with mine",
                    "Crossing every single line!",
                    "Engine screams the name of night:",
                    "يا ليل! (Ya Layl!)",
                    "Burning through the neon light:",
                    "يا ليل! (Ya Layl!)"
                ]
            },
            { 
                id: 2, 
                name: "Gönül Yarası", 
                url: "https://audio.jukehost.co.uk/w6ljByylsvFth6LBE48dCCqdd0Ki9mUH", 
                duration: "8:28",
                lyrics: [
                    "Güzelim, çıktı başımdan duman",
                    "Bu aşkın elemi bitsin artık yaman",
                    "",
                    "Yaktın beni aman, o bakışınla yar",
                    "Bu hasretlik ömre bedel, gel olmasın ayrılık",
                    "Sensiz geçmiyor hiç bir an, canan",
                    "Bu hasretlik ömre bedel, gel olmasın ayrılık",
                    "",
                    "Her gece sensizlik oldu bana dert",
                    "Gel hadi çare ol, bitsin bu kara sert",
                    "",
                    "Yaktın beni aman, o bakışınla yar",
                    "Bu hasretlik ömre bedel, gel olmasın ayrılık",
                    "Sensiz geçmiyor hiç bir an, canan",
                    "Bu hasretlik ömre bedel, gel olmasın ayrılık",
                    "",
                    "Gel olmasın ayrılık...",
                    "Canan..."
                ]
            },
            { 
                id: 3, 
                name: "Good Bye Yesterday", 
                url: "https://audio.jukehost.co.uk/aRDwAN2KfAQ3rC2SqPdxEbF3eCtsz6A5", 
                duration: "2:49",
                lyrics: [
                    "Goodbye, yesterday's tears and pain,",
                    "Washed clean by morning's gentle rain.",
                    "Thank You, God, for this brand new start,",
                    "Hope rising fresh within my heart.",
                    "Sunlight chases shadows long,",
                    "To Your mercy we belong.",
                    "",
                    "Oh, Today! Your freedom's sweet!",
                    "Lift our souls with dancing feet!",
                    "With every breath, Your love we feel,",
                    "Grace is true, and mercy's real!",
                    "Let the bağlama ring, the modern beat ignite,",
                    "We dance in Your forgiving light!",
                    "",
                    "Golden Horn shines, troubles fade away,",
                    "Thanking God for this blessed day.",
                    "This rhythm divine, a joyful sound,",
                    "In Your loving arms we're found."
                ]
            },
            { 
                id: 4, 
                name: "Run It", 
                url: "https://audio.jukehost.co.uk/rJ2qe2cxumUkdpqjXBzgIsPw5xfsWLNh", 
                duration: "5:00",
                lyrics: [
                    "Yeah... run it... run it... check it.",
                    "",
                    "Lights down low, feel the bassline creep",
                    "In my soul, yeah, the promise I keep",
                    "Floor is shaking, heartbeat in my chest",
                    "Gonna show 'em all how I pass the test",
                    "",
                    "One look, one touch, feel the energy rise",
                    "See the fire reflected in your eyes",
                    "The world disappears, it's just you and the sound",
                    "Yeah, watch me now as I take the crown",
                    "",
                    "Run it, own it, lock it, show it",
                    "Beat drops down and you already know it",
                    "Flip it, switch it, don't you ever quit it",
                    "This whole night, yeah, we're about to get it",
                    "",
                    "See the crowd moving, swaying side to side",
                    "In this moment, nowhere left to hide",
                    "Every single move, yeah, they're watching me",
                    "Set the tempo, feel it, wild and free",
                    "",
                    "One look, one touch, feel the energy rise",
                    "See the fire reflected in your eyes",
                    "The world disappears, it's just you and the sound",
                    "Yeah, watch me now as I take the crown",
                    "",
                    "Run it, own it, lock it, show it",
                    "Beat drops down and you already know it",
                    "Flip it, switch it, don't you ever quit it",
                    "This whole night, yeah, we're about to get it",
                    "",
                    "Just breathe... feel the sound",
                    "Let the rhythm take you, all around",
                    "From the ceiling to the ground",
                    "This is where the magic's found",
                    "",
                    "Run it, own it, lock it, show it",
                    "Beat drops down and you already know it",
                    "Flip it, switch it, don't you ever quit it",
                    "This whole night, yeah, we're about to get it",
                    "",
                    "Run it... own it...",
                    "Flip it... switch it...",
                    "Yeah... we run the night."
                ]
            },
            { 
                id: 5, 
                name: "Söndüremezler", 
                url: "https://audio.jukehost.co.uk/ji9ogU5yJ3bkAatfaf4RO6FpV2YAgDQK", 
                duration: "3:24",
                lyrics: [
                    "Ne denilse, ne tekrarlansa,",
                    "Sen kalbimde tek ve bir tanesin.",
                    "Gözlerinde gördüm cümle alemi,",
                    "O rüya gibi ömür, sensin en derin.",
                    "",
                    "Ne söylerlerse söylesinler,",
                    "Benden uzaklaşamazsın, değişemem.",
                    "Daha da güçlenir bu sevgi,",
                    "İsterlerse güneşi söndürmeye çalışsınlar!",
                    "Söndüremezler! Söndüremezler!",
                    "",
                    "Aramıza bin fersah koysalar,",
                    "Bu kader bize gökyüzünde yazılmış.",
                    "Son nefesime kadar, ey kaderim,",
                    "Sana yine de gelirdim, peşinden koşardım.",
                    "",
                    "Ne söylerlerse söylesinler,",
                    "Benden uzaklaşamazsın, değişemem.",
                    "Daha da güçlenir bu sevgi,",
                    "İsterlerse güneşi söndürmeye çalışsınlar!",
                    "Söndüremezler! Söndüremezler!",
                    "",
                    "Neden almak istiyorlar kalbimden seni?",
                    "Neden suçluyor herkes bu sevgiyi?",
                    "",
                    "Ne söylerlerse söylesinler,",
                    "Benden uzaklaşamazsın, değişemem!",
                    "Daha da güçlenir bu sevgi,",
                    "İsterlerse GÜNEŞİ SÖNDÜRMEYE ÇALIŞSINLAR!",
                    "SÖNDÜREMEZLER!"
                ]
            },
            { 
                id: 6, 
                name: "YAR YAR", 
                url: "https://audio.jukehost.co.uk/P4HsEtSDGNmBevczBrJLakNOt3fweydf", 
                duration: "2:26",
                lyrics: [
                    "Gözlerinde bir ışık parlıyor,",
                    "Yüklerini bırak, gel yanıma!",
                    "Dünya bizimle birlikte dönsün,",
                    "Bu gece sonsuz, inan bana.",
                    "",
                    "Eller havada, kalpler tek!",
                    "Zamana meydan, haydi gel!",
                    "Acılar uçup gitsin,",
                    "Yeni bir gün doğsun.",
                    "",
                    "Yüksek sesle haykır: 'Yar yar yar!'",
                    "Dans et! Özgürce dön!",
                    "Yan yana, hep beraber,",
                    "Bu aşk hiç sönmesin!",
                    "Yüreklerde tek nefes,",
                    "Gökyüzü bize gülsün!",
                    "",
                    "Adımların ritmi sarsın,",
                    "Geceyi biz yıkalım!",
                    "Sözümüz var: Hep birlikte,",
                    "Yarınlara koşalım!",
                    "",
                    "Aşk ateşi yandı,",
                    "Sönmez bu bağ, bu sevda!",
                    "Sadakat bizim yoldaş,",
                    "Unutma: 'Tek yürek oldukça!'",
                    "",
                    "Yüksek sesle haykır: 'Yar yar yar!'",
                    "Dans et! Özgürce dön!",
                    "Yan yana, hep beraber,",
                    "Bu aşk hiç sönmesin!",
                    "Yüreklerde tek nefes,",
                    "Gökyüzü bize gülsün!",
                    "",
                    "Ah, yar yar yar...",
                    "Bu gece sonsuz bizde!",
                    "Yar yar yar...",
                    "Hepimiz biriz işte!"
                ]
            }
        ];

        // Global variables
        let audioContext;
        let analyser;
        let source;
        let audioElement;
        let isPlaying = false;
        let currentTrackIndex = 0;
        let animationId;
        let gridInterval;

        // Sound effects using Web Audio API
        function playClickSound() {
            try {
                const clickContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = clickContext.createOscillator();
                const gainNode = clickContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(clickContext.destination);
                
                oscillator.frequency.setValueAtTime(800, clickContext.currentTime);
                oscillator.frequency.exponentialRampToValueAtTime(200, clickContext.currentTime + 0.05);
                
                gainNode.gain.setValueAtTime(0.3, clickContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, clickContext.currentTime + 0.05);
                
                oscillator.start(clickContext.currentTime);
                oscillator.stop(clickContext.currentTime + 0.05);
            } catch (e) {
                console.log("Sound effect not supported");
            }
        }

        // Initialize the player
        function initPlayer() {
            // Create audio element
            audioElement = new Audio();
            audioElement.crossOrigin = "anonymous";
            
            // Set up audio context for visualization
            try {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
                analyser = audioContext.createAnalyser();
                analyser.fftSize = 256;
                
                source = audioContext.createMediaElementSource(audioElement);
                source.connect(analyser);
                analyser.connect(audioContext.destination);
            } catch (e) {
                console.error("Web Audio API not supported", e);
            }

            // Set up event listeners
            audioElement.addEventListener('loadedmetadata', updateTrackInfo);
            audioElement.addEventListener('timeupdate', updateProgress);
            audioElement.addEventListener('ended', handleTrackEnd);
            
            // Set initial volume to 100%
            audioElement.volume = 1.0;
            
            // Initialize playlist
            renderPlaylist();
            
            // Initialize visualizer
            initVisualizer();
            
            // Start grid background
            gridInterval = setInterval(drawGrid, 50);
            
            // Set up lyrics panel
            document.getElementById('showLyricsBtn').addEventListener('click', showLyricsPanel);
            document.getElementById('closeLyricsBtn').addEventListener('click', hideLyricsPanel);
        }

        // Render the playlist
        function renderPlaylist() {
            const playlist = document.getElementById('playlist');
            playlist.innerHTML = '';
            
            tracks.forEach((track, index) => {
                const trackItem = document.createElement('div');
                trackItem.className = 'track-item';
                if (index === currentTrackIndex) {
                    trackItem.classList.add('active-track');
                }
                
                trackItem.innerHTML = `
                    <div class="track-number">${track.id}</div>
                    <div class="track-name">${track.name}</div>
                    <div class="track-duration">${track.duration}</div>
                `;
                
                trackItem.addEventListener('click', () => {
                    playClickSound();
                    playTrack(index);
                });
                
                playlist.appendChild(trackItem);
            });
        }

        // Show lyrics panel
        function showLyricsPanel() {
            playClickSound();
            document.getElementById('lyricsPanel').style.display = 'block';
            updateLyrics();
        }

        // Hide lyrics panel
        function hideLyricsPanel() {
            playClickSound();
            document.getElementById('lyricsPanel').style.display = 'none';
        }

        // Update lyrics display
        function updateLyrics() {
            const lyricsContent = document.getElementById('lyricsContent');
            const currentTrack = tracks[currentTrackIndex];
            
            if (!currentTrack.lyrics) {
                lyricsContent.innerHTML = '<div class="lyrics-line">No lyrics available for this track</div>';
                return;
            }
            
            // Clear previous lyrics
            lyricsContent.innerHTML = '';
            
            // Add all lyrics lines
            currentTrack.lyrics.forEach((line, index) => {
                const lyricLine = document.createElement('div');
                lyricLine.className = 'lyrics-line';
                lyricLine.textContent = line;
                lyricsContent.appendChild(lyricLine);
            });
        }

        // Play a specific track
        function playTrack(index) {
            currentTrackIndex = index;
            
            // Stop current playback
            if (isPlaying) {
                audioElement.pause();
                isPlaying = false;
            }
            
            // Load new track
            audioElement.src = tracks[index].url;
            document.getElementById('trackTitle').textContent = tracks[index].name;
            document.getElementById('trackArtist').textContent = `TRACK ${tracks[index].id}`;
            
            // Update active track in playlist
            renderPlaylist();
            
            // Update lyrics if panel is open
            if (document.getElementById('lyricsPanel').style.display === 'block') {
                updateLyrics();
            }
            
            // Play the track
            togglePlayPause();
        }

        // Update track info when metadata is loaded
        function updateTrackInfo() {
            document.getElementById('trackDuration').textContent = formatTime(audioElement.duration);
        }

        // Update progress bar and time display
        function updateProgress() {
            const progress = document.getElementById('progress');
            const currentTrackTime = document.getElementById('currentTrackTime');
            
            if (audioElement.duration) {
                const percent = (audioElement.currentTime / audioElement.duration) * 100;
                progress.style.width = percent + '%';
                currentTrackTime.textContent = formatTime(audioElement.currentTime);
            }
        }

        // Format time in MM:SS
        function formatTime(seconds) {
            if (isNaN(seconds)) return '0:00';
            
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins}:${secs < 10 ? '0' : ''}${secs}`;
        }

        // Handle track end
        function handleTrackEnd() {
            playNextTrack();
        }

        // Play next track
        function playNextTrack() {
            currentTrackIndex = (currentTrackIndex + 1) % tracks.length;
            playTrack(currentTrackIndex);
        }

        // Play previous track
        function playPrevTrack() {
            currentTrackIndex = (currentTrackIndex - 1 + tracks.length) % tracks.length;
            playTrack(currentTrackIndex);
        }

        // Toggle play/pause
        function togglePlayPause() {
            if (!audioElement.src) {
                // If no track is loaded, load the first one
                playTrack(0);
                return;
            }
            
            if (isPlaying) {
                audioElement.pause();
                document.getElementById('playPauseBtn').textContent = '▶';
            } else {
                // Resume audio context if suspended
                if (audioContext && audioContext.state === 'suspended') {
                    audioContext.resume();
                }
                
                audioElement.play().then(() => {
                    document.getElementById('playPauseBtn').textContent = '⏸';
                    startVisualizer();
                }).catch(e => {
                    console.error("Play failed:", e);
                });
            }
            
            isPlaying = !isPlaying;
        }

        // Initialize visualizer
        function initVisualizer() {
            const canvas = document.getElementById('waveCanvas');
            const ctx = canvas.getContext('2d');
            
            // Set canvas dimensions
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;
            
            // Start animation loop
            animateVisualizer();
        }

        // Start visualizer animation
        function startVisualizer() {
            if (animationId) {
                cancelAnimationFrame(animationId);
            }
            animateVisualizer();
        }

        // Animate visualizer - Simple Elegant Waves
        function animateVisualizer() {
            const canvas = document.getElementById('waveCanvas');
            const ctx = canvas.getContext('2d');
            
            // Clear canvas with slight transparency for trail effect
            ctx.fillStyle = 'rgba(0, 0, 0, 0.1)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            if (isPlaying && analyser) {
                // Get frequency data
                const bufferLength = analyser.frequencyBinCount;
                const dataArray = new Uint8Array(bufferLength);
                analyser.getByteFrequencyData(dataArray);
                
                // Draw simple elegant waves
                const centerY = canvas.height / 2;
                const sliceWidth = canvas.width / bufferLength;
                
                // Primary wave - very thin and elegant
                ctx.strokeStyle = '#0f0';
                ctx.lineWidth = 1;
                ctx.beginPath();
                
                let x = 0;
                for (let i = 0; i < bufferLength; i++) {
                    const v = dataArray[i] / 128.0;
                    const y = centerY + (v * centerY / 3) * Math.sin(x * 0.02);
                    
                    if (i === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                    
                    x += sliceWidth;
                }
                ctx.stroke();
                
                // Secondary wave - very subtle
                ctx.strokeStyle = 'rgba(0, 255, 0, 0.3)';
                ctx.lineWidth = 0.5;
                ctx.beginPath();
                
                x = 0;
                for (let i = 0; i < bufferLength; i += 2) {
                    const v = dataArray[i] / 128.0;
                    const y = centerY - (v * centerY / 4) * Math.cos(x * 0.015);
                    
                    if (i === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                    
                    x += sliceWidth * 2;
                }
                ctx.stroke();
                
                // Draw minimalist frequency dots
                ctx.fillStyle = 'rgba(0, 255, 0, 0.6)';
                const dotCount = 8;
                const dotSpacing = canvas.width / (dotCount + 1);
                
                for (let i = 1; i <= dotCount; i++) {
                    const dotIndex = Math.floor(i * bufferLength / (dotCount + 1));
                    const dotSize = dataArray[dotIndex] / 255 * 2;
                    const dotX = i * dotSpacing;
                    const dotY = centerY + (Math.sin(Date.now() * 0.001 + i) * 5);
                    
                    if (dotSize > 0.3) {
                        ctx.beginPath();
                        ctx.arc(dotX, dotY, dotSize, 0, Math.PI * 2);
                        ctx.fill();
                    }
                }
                
                // Draw center line
                ctx.strokeStyle = 'rgba(0, 255, 0, 0.1)';
                ctx.lineWidth = 0.3;
                ctx.beginPath();
                ctx.moveTo(0, centerY);
                ctx.lineTo(canvas.width, centerY);
                ctx.stroke();
            }
            
            animationId = requestAnimationFrame(animateVisualizer);
        }

        // Set up event listeners with sound effects
        document.getElementById('playPauseBtn').addEventListener('click', () => {
            playClickSound();
            togglePlayPause();
        });
        
        document.getElementById('prevBtn').addEventListener('click', () => {
            playClickSound();
            playPrevTrack();
        });
        
        document.getElementById('nextBtn').addEventListener('click', () => {
            playClickSound();
            playNextTrack();
        });

        // Initialize on load
        window.addEventListener('load', initPlayer);

        // Handle window resize
        window.addEventListener('resize', () => {
            const canvas = document.getElementById('waveCanvas');
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;
            
            // Resize grid canvas
            gridCanvas.width = window.innerWidth;
            gridCanvas.height = window.innerHeight;
        });
    </script>
</body>
</html>
